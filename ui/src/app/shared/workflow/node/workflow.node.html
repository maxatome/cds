<div class="workflowNode">
    <div class="nodePipeline" [class.running]="currentNodeRun?.status === pipelineStatus.BUILDING || currentNodeRun?.status === pipelineStatus.WAITING"
         [class.building]="currentNodeRun?.status === pipelineStatus.BUILDING || currentNodeRun?.status === pipelineStatus.WAITING"
         [class.success]="currentNodeRun?.status === pipelineStatus.SUCCESS"
         [class.fail]="currentNodeRun?.status === pipelineStatus.FAIL || currentNodeRun?.status === pipelineStatus.STOPPED"
         [class.inactive]="currentNodeRun?.status === pipelineStatus.DISABLED || currentNodeRun?.status === pipelineStatus.SKIPPED"
         [class.pointing]="currentNodeRun"
         [class.active]="node.id === selectedNodeId"
         (click)="goToNodeRun()">

        <!-- Node name + pipeline name -->
        <div class="pipeline">
            <p class="ellipsis">
                <span *ngIf="workflowRun && workflowRun.status && !loadingStop &&
                    workflowRun.status !== pipelineStatus.BUILDING &&
                    workflowRun.status !== pipelineStatus.WAITING &&
                    currentNodeRun?.status !== pipelineStatus.BUILDING &&
                    currentNodeRun?.status !== pipelineStatus.WAITING"
                    class="pointing">
                    <i class="video play outline icon" (click)="openRunNode($event)"></i>
                </span>
                <ng-container *ngIf="currentNodeRun && (currentNodeRun?.status === pipelineStatus.BUILDING || currentNodeRun?.status === pipelineStatus.WAITING)">
                    <div class="ui active inline blue loader mr5 pointing"  (click)="stopNodeRun($event)">
                        <i class="black stop icon build" *ngIf="!loadingStop"></i>
                    </div>
                </ng-container>
                <span class="ui black circular label mr5" *ngIf="currentNodeRun">
                    {{ currentNodeRun?.subnumber }}
                </span>
                <span>
                    <b>{{node.name}}</b>
                </span>
            </p>
        </div>

        <!-- area to display application name -->
        <div class="footer" *ngIf="node.context.application_id && node.context.application_id > 0 && !displayInputName">
            <p class="ellipsis">{{node.context.application.name}}</p>
        </div>

        <!-- environment name on a semantic ui ribbon -->
        <a class="ui white ribbon label" *ngIf="node.context.environment_id && node.context.environment_id > 0">{{node.context.environment?.name}}</a>
    </div>

</div>
<ng-container *ngIf="project && node">
    <app-workflow-node-run-param [workflow]="workflow" [project]="project" [nodeRun]="currentNodeRun" [nodeToRun]="node" [num]="workflowRun?.num" #workflowRunNode></app-workflow-node-run-param>
</ng-container>
